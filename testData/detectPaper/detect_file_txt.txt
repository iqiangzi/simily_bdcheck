北京农学院学报JoURNAL oF BEIJING AGRICULTURAL CoLLEGEJul. 1999主成分——逐步回归——BP算法在近红外光谱定量分析中应用的研究齐小明D 张录达2’ 柴丽娜¨ 严衍禄2’ 潘大志2’㈡北京农学院基础科学系，北京102206；2’中国农业大学，北京 102206）
本文提出一种新的B—P算法：主成分一逐步回归一BP算法。用于近红外光谱定量分析中，其所建模型的预测精度明显高于以往的逐步回归一BP算法和主成分一BP算法。
 主成分一逐步回归一BP算法；近红外光谱；定量分析l 引 言
近红外谱区（800-2500nm）主要由分子振动的倍频与和频产生，谱带较宽，吸收强度较弱。从该区可得到分子中含氢集团的振动信息，其信息量远比紫外谱区大，可成功地用于定量分析。然而，近红外光谱（NIR）严重重叠，分析仪器提供的是矢量类型数据，需用化学计量学方法建立多元回归模型进行分析和预测。
回归模型可分为线性和非线性两大类。有研究表明近红外光谱的响应是非线性的。所以建立非线性模型更能反映其光谱数据和组分含量间的关系。
人工神经网络（ANN）是新兴的处理非性线问题的三大方法（模糊逻辑、人工智能、人工神经网络）之一。其中的误差反向传播算法（B—P），采用有导师学习算法建模，已被证明可以逼近任意非线性曲线，在模糊推理、智能控制、股票分析等方面获得广泛应用。如何用它处理NIR的非线性问题，国内外很多研究者作了大量试验。结果表明，将光谱仪生成的成百上千个采样数据直接输入B-P网，既使建一个只含三层结点的网，其计算量之大也是目前微机难以承受的。而且这样建成的模型会对输出产生“过拟合”，其预测的适应能力反而大大下降。所以目前多用逐步回归法、主成分法等线性算法将原始数据压缩为几个自变量后输入B—P网（或者说用B—P网确定这些线性模型中的自变量系数）。于是产生了逐步回归一BP算法（SRA—BP）n3、主成分一BP算法（PCR—BP）03等多种非线性建模方法。这些模型的预测精度比相应的线性算法高，但不如偏最小二乘法。因此，如何提高其预测精度是B—P算法面临的一大难题。为此，许多研究者对B—P网本身提出了改进算法。
本研究结果表明：影响B—P网预测精度的另一原因是必须正确选择自变量，尽量做到“少而精”，使它们既包含尽量多的原始信息又能尽量减少各自的相关性，这和建立线性模型的要求是一致的。因此我们提出一个新的前期压缩数据的B—P算法：主成分一逐步
收稿日期：1999一oS一10回归一BF算法（PCR—SRA—BP）。它先用主成分法把原自变量映射为主成分，其所得的主成分是对样本中所有组分得分最多的，但对样品中的每个组分并不一定都是相关性最大的，因此再用这些主成分对各组分分别进行逐步回归，选出各自偏爱的主成分分别输入B—P网，进行学习和预测。实验结果表明，此法的预测精度明显高于PCR—BP算法和SRA—BP算法.2实验环境及评价指标2。1仪器设备及软件傅里叶型近红外光谱仪（Bruker公司生产。VECTER／22N型），性能指标如下：
扫描波数范围（光导纤维）：15000-4000cm叫分辨率：优于0。1cm-1信噪比（S／N）：10000漫反射（S／N）≥3000波长准确度：优于O。2cm。
赛扬300A微型计算机一台，CCAUNIR2—1 for Windows95近红外光谱分析软件-套，以及各种线性、非线性多元校正等程序（多数采用MS—Visual C++5。0编写）。大多数程序软件都在windosw95下运行。
2。2 实验材料由中国农业科学院品质资源研究所提供的小麦样品60个，见表1。硫酸钡（分析纯）。
2。3样品的处理、光谱的获得和校正集的选择1）样品的处理与化学标定样品由中国农业科学院作物品质资源研究所处理，并进行化学标定。表1列出了60个小麦样品的蛋白质百分含量的化学标定值。其中蛋白质的含量（%）范围为12。14%-19。34%，平均值与标准差分别为15。53和2。72。
2）样品的近红外漫反射光谱的测量用傅里叶型光谱仪采集小麦样品的近红外漫反射光谱，仪器的参数为：
扫描区间为：12000-4000cm-1扫描分辩率为：4cml扫描次数为：100次取平均孔径:OPEN将硫酸钡粉末装入样品池，刮平后用压模工具压平，使表面保持平整，作参比样品用。
将小麦样品搅拌松散、均匀，装入样品池后刮平，用压模工具压平，使表面平整。每个样品装样3次，分别扫描，取其平均光谱用于定量分析。
3）样品集的选择用随机选法将小麦样品的后30个作为校正集，前30个作为预测集。
4）分析谱区的选取及前处理分析谱区采用了部分的扫描区间范围（4000-8000cm叫），间隔点为2，即在4000-8000cm叫区间每两个波长点选取一个数据点。前处理方法采用一阶导数13点平滑。
表1 60个小麦样品的蛋白质百分比含量（化学标定值）。
＊样品1-30为预测集。31-60为校正集5）校正模型评价指标——决定系数（R2）
∑(H一或)2R:＝(1一 )×100y(yi—y优)z?:＝l，z：样本数y：第i个样品的预测值y。：第i个样品的参考值（真值）
y，”：样本真值的平均值
3 实验过程
(2.1)
3。1 逐步回归一BP算法用校正集中的30个样品对组分输出进行逐步回归，在F1＝F2—1。4时从104个光谱采样点中选出6个，它们是XX。；、X。n X。将这6个自变量输入B—P网的输入层结点，建立一个三层B—P网。经多次实验比较，确定隐含层结点数为8、输出层结点数为1时，其学习速度较快，预测精度较高。“3。
目标误差值对预测精度影响很大，其值减小时学习集的预测精度可大大提高，但预测集的反而下降。多次实验结果表明，目标误差值为0。005时，预测决定系数达到最高值：
89.20.3。2主成分一BP算法用主成分法将104个光谱采样值变换压缩为主成分（潜变量），用其前6个：Xh Xz、X输入B—P网进行建模和预测。
型后将预测集的30个样品输入，得到预测结果，3。3主成分一逐步回归一BP算法即用校正集中的30个样品学习，建立模算出预测决定系数为92。50。
用校正集的30个样品，对前20个主成分和样品的蛋白质含量作逐步回归。在F1一F2—4。2时求得6个主成分，它们是XX。、Xn XX，、X。。
用这6个主成分作为自变量输入B—P网进行建模和预测。即先用校正集中的30个样品对其训练建立模型，再用预测集的30个样品进行预测，求得决定系数达96。49。
4 几种B—P算法的比较与结论
表2列出了上述3种B—P算法对30个小麦样品的蛋白质含量预测结果。为便于比较
将SRA、PCR、PCR—SRA等三种线性算法的预测结果也列于表内.从决定系数看各种算法的预测能力，由高到低，其顺序为PCR—SRA—BP、PCR—SRA、PCR—BP、SRA—BP、PCR、SRA.从表中看到SRA和PCR两种算法的预测精度比一般实验偏低，原因之一是校正集样品数较少（这样可减少B—P算法的学习时间）。对SRA来说更重要的是自变量个数太少（它没有数据变换压缩能力）。这对PCR—SRA—BP网却有利，既可减少学习时间又可避免发生过拟合。
和建立线性模型一样，“少而精”地选择自变量，使它们既包含尽量多的原始信息又能尽量减少各自的相关性，是提高B—P网预测精度的关键之一。本研究用主成分一逐步回归算法选择的自变量输入B—P网，所建模型的预测能力明显高于逐步回归一BP算法和主成分一BP算法，而且大大加快了学习时的收敛速度。原因是它利用了两种线性算法的优点来弥补各自的缺点。使所选的自变量更加合理。
主成分法的数据压缩能力极强，但其所得的主成分是对样本中所有组分得分最多的，对样品中的每个组分其相关程度并不相同。再用逐步回归法分别挑选各组分偏爱的主成分去分别输入BP网建立模型，从而弥补了主成分一BP算法不按样本各组分需要选择自变量建模的缺点。
逐步回归法虽然根据因变量的需要选择自变量，但它没有数据变换压缩的能力。而且，其所选的自变量的优劣和校正集样品原始变量的排列顺序以及选多少自变量有关。要想得到最佳选择需在每种排列顺序下建立所有可能得到的、变量个数不同（靠F1、F2值不同，选择变量的个数不同）的变量集，再输入BP网进行学习和预测，根据预测结果选出其中最好的，其汁算量之大可想而知。用主成分法先将上千个采样点映射成几乎含全部信息的十几个潜变量一主成分。而且按其所含信息量的大小顺序排列。这无疑是逐步回归法挑选自变量的最好顺序，只要选择一次，即可得到最佳结果。
表2 几种线性和非线性算法对30个小麦样品蛋白质含量的预测结果’
1＊REF。表示小麦样品蛋白质百分比含量，P S—BP表示PCR—SRA—BP算法
吉海彦.严衍禄.用人工神经网络处理谷物成分分析.高等学校化学学报,1993,14(5):618-620Paul J.Gemperline.James eI.Nonlinear Multivariate Calibration Using Principal Components Regres—sion Artificial Networks. Anal. Chem..1991,66(20):胡守仁,余少波.戴 葵."神经网络导轮".北京:国际科技大学出版社,1993Arai M.Mapping ability of three一1ayer networks.In:Proc 89 IEEE Int Joint Con on Neural Networks.
V01 1.Washington DC:IEEE TAB Neural Network Committee.1989焦李成.神经网络系统理论.西安:西安电子科技大学出版社,1995赵振宇.徐作懋.模糊理论和神经网络的基础与应用.北京:清华大学出版社,一Study of Near-Infrared Spectra for Quantitative AnalysisUsing Principal Component—stepwise Regression—BP AlgorithmQi Xiaoming甜倪Z(Beijing Agricultural College,Beijing 1 02206)
Absn’act Back Propagation network (B-P)has been used in Near—Infrared sDectra(NIR)for many years.But the important thing is how to improve its prediction precision.
In thls study? we put forward Principal component—stepwise regression-BP algorithm(PCR—SRA—BP). It is superior to SRA—BP and PCR—BP algorithm in prediction andthe speed of learning.
Key words Near—Infrared spectra;Quantitative Analysis;Principal component—stepwise
regression—BP algorithm
